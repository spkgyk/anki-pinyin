!function () { var e = "0.3", t = "simplified", n = "traditional", o = ["big5", "big5-hkscs", "x-euc-tw"], i = ["gb2312", "gbk", "x-gbk", "gb18030", "hz-gb-2312", "iso-2022-cn"].concat(o, ["utf-7", "utf-8", "utf-16le", "x-user-defined"]), a = !1, d = "PMingLiU,MingLiU,新細明體,細明體", l = "MS Song, 宋体, SimSun", s = {}, r = {}, u = 1, c = 1, h = "", f = "", m = [["X", "TongWen.hiddenToolbar();"], ["繁", "TongWen.trans2Trad();"], ["簡", "TongWen.trans2Simp();"], ["測試", "TongWen.twtest();"]], g = 0, b = 0, v = window.TongWen = function () { f = "tongwen-" + Math.ceil(1e6 * Math.random()), document.addEventListener ? document.addEventListener("DOMContentLoaded", function () { p() }, !1) : window.attachEvent && window.attachEvent("onload", p); return { version: e, addS2TTable: x, addT2STable: R, convert: k, transPage: E, trans2Trad: S, trans2Simp: A, transAuto: B, showToolbar: function () { b = 0, function () { var e = document.getElementById(f); if (null != e) e.style.display = ""; else { if (b > 10) return; b++, setTimeout(function () { v.showToolbar() }, 500) } }() }, hiddenToolbar: function () { b = 0, function () { var e = document.getElementById(f); if (null != e) e.style.display = "none"; else { if (b > 10) return; b++, setTimeout(function () { v.hiddenToolbar() }, 500) } }() }, enableCustomFontset: w, setTradFontset: y, setSimpFontset: T, twtest: function () { document.styleSheets.length <= 0 && document.body.appendChild(document.createElement("style")), alert(document.styleSheets.length), document.styleSheets[0].addRule("*", "font-size: 18pt;") } } }(); function p() { !function () { document.body.appendChild(document.createElement("style")), g = document.styleSheets.length - 1; var e = document.styleSheets[g]; e.insertRule && void 0 === e.addRule && (e.addRule = function (e, t, n) { void 0 === n ? this.insertRule(e + " { " + t + " }", this.cssRules.length) : this.insertRule(e + "{" + t + "}", n) }); e.addRule("#" + f, "position: fixed; width: auto; height: 26px; top: 0; right: 0; background-color: #E5E5E5; border-width: 1px 0 1px 1px; border-color: #808080 #B5B5B5 #B5B5B5 #B5B5B5; border-style: solid;"), e.addRule("#" + f, "_position: absolute;"), e.addRule("#" + f + " a", "color: #005884; text-decoration: none; font-size: 16px;"), e.addRule("#" + f + " a:hover", "color: #005884; text-decoration: underline;"), e.addRule("#" + f + " a:visited", "color: #005884; text-decoration: none;") }(), function () { var e = document.createElement("div"); e.setAttribute("id", f), e.style.display = "none", document.body.appendChild(e); for (var t = '<table cellspacing="1" cellpadding="2" border="0"><tr>', n = 0, o = m.length; n < o; n++)t += '<td><a href="#" onclick="' + m[n][1] + ' return false;">' + m[n][0] + "</a></td>"; t += "</tr></table>", e.innerHTML = t }() } function w(e) { a = e } function y(e) { d = e } function T(e) { l = e } function x(e) { for (var t in e) u = Math.max(u, e[t].length), r[t] = e[t] } function R(e) { for (var t in e) c = Math.max(c, e[t].length), s[t] = e[t] } function k(e, n) { var o = 4, i = null; n == t ? (i = s, o = Math.min(c, e.length)) : (i = r, o = Math.min(u, e.length)); for (var a = 0, d = (e = e.split("")).length; a < d; a++)e[a] = i[e[a]] || e[a]; var l = "", h = "", f = !0; for (a = 0, d = (e = e.join("")).length; a < d;) { f = !0; for (var m = o; m > 1; m--)if ((h = e.substr(a, m)) in i) { l += i[h], a += m, f = !1; break } f && (l += e.substr(a, 1), a++) } return "" != l && (e = l), e } function E(e, o) { h = o, function (e, t) { e.documentElement.setAttribute("zhtongwen", t) }(e, o), e.title = k(e.title, o), function (e, t) { var n = [], o = []; n.push(e), setTimeout(function e() { if (n.length <= 0) { if (o.length <= 0) return; E(o.shift(), t) } var i = n.shift(), a = null; switch (i.nodeType) { case 1: if (i.id == f) break; switch (i.nodeName.toLowerCase()) { case "frame": case "iframe": void 0 !== i.contentDocument ? E(i.contentDocument, t) : void 0 !== i.contentWindow && void 0 !== i.contentWindow.document && E(i.contentWindow.document, t); break; case "embed": case "object": case "script": case "style": case "title": case "br": case "hr": case "noscript": case "script": break; case "img": null != (a = i.getAttribute("title")) && i.setAttribute("title", k(a, t)), null != (a = i.getAttribute("alt")) && i.setAttribute("alt", k(a, t)); break; case "input": switch (i.type.toLowerCase()) { case "button": case "submit": case "reset": i.value.length > 0 && (i.value = k(i.value, t)) }break; case "option": i.text.length > 0 && (i.text = k(i.text, t)); break; default: if (null != (a = i.getAttribute("title")) && i.setAttribute("title", k(a, t)), i.hasChildNodes()) for (var d = 0, l = i.childNodes.length; d < l; d++)"139".indexOf(i.childNodes[d].nodeType) < 0 || n.push(i.childNodes[d]) }break; case 3: var s = i.nodeValue; s.length > 0 && (i.nodeValue = k(s, t)), e(); break; case 9: if (i.hasChildNodes()) for (d = 0, l = i.childNodes.length; d < l; d++)"139".indexOf(i.childNodes[d].nodeType) < 0 || n.push(i.childNodes[d]) }(n.length > 0 || o.length > 0) && setTimeout(e, 1) }, 1) }(e, o), a && function (e) { var o = ""; e == n ? o = " font-family: " + d + ";" : e == t && (o = " font-family: " + l + ";"); var i = document.styleSheets[g]; i.insertRule && void 0 === i.addRule && (i.addRule = function (e, t, n) { void 0 === n ? this.insertRule(e + " { " + t + " }", this.cssRules.length) : this.insertRule(e + " {" + t + "}", n) }), i.addRule("*", o) }(o) } function S(e) { E(e || document, n) } function A(e) { E(e || document, t) } function B(e) { var a = e || document, d = a.characterSet.toLowerCase(); if ("" == (h = function (e) { var t = ""; return e && e.documentElement && null == (t = e.documentElement.getAttribute("zhtongwen")) && (t = ""), t }(e))) { var l = a.documentElement.getAttribute("lang"); if (null != l) switch (l.toLowerCase()) { case "zh-tw": case "zh-hk": h = t; break; case "zh-cn": h = n }"" == h && i.indexOf(d) >= 0 && (h = o.indexOf(d) >= 0 ? t : n) } else h = h == n ? t : n; "" != h && E(a, h) } }();